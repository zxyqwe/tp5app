{layout name="layout" /}
<div class="container-fluid" style="padding-bottom: 70px;">
    <div id="container" class="col-md-10 col-md-offset-1 column">
        <div id="body">
            <h1>
                积分排行榜
            </h1>
            <p>前五十名选手，每十分钟刷新一次</p>
            <div>
                <table id="table"
                       data-url="/hanbj/dataopen/json_bonus">
                    <thead>
                    <tr>
                        <th data-field="i">排名</th>
                        <th data-field="t">昵称</th>
                        <th data-field="u">会员编号</th>
                        <th data-field="y">注册年份</th>
                        <th data-field="o">积分</th>
                    </tr>
                    </thead>
                </table>
                <p></p>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="/static/hanbj_bulletin.js"></script>
<script>
    var bonus = (function ($, w, undefined) {
        'use strict';
        var init = function () {
            var $table = $('#table');
            $table.bootstrapTable({
                responseHandler: function (res) {
                    var base = 0;
                    var tmpb = 0;
                    var msg = res.rows;
                    for (var i in msg) {
                        var bonus = parseInt(msg[i].o);
                        if (bonus !== tmpb) {
                            base = i + 1;
                            tmpb = bonus;
                        }
                        msg[i].i = base;
                    }
                    return res;
                }
            });
        };
        return {
            init: init
        };
    })(jQuery, window);
    var nav = 'nav1_4';
    $(window).load(function () {
        bonus.init();
    });
</script>