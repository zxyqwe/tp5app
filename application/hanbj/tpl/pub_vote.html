{layout name="layout_pc_open" /}
<div class="container-fluid" style="padding-bottom: 70px;">
    <div id="container" class="col-md-10 col-md-offset-1 column">
        <h1>换届选举 - 结果实时公示</h1>
        <div id="body">
            <p>刷新时间：{{ refresh }}</p>
            <p>todo progress bar</p>
            <p>{{ ans }}</p>
        </div>
    </div>
</div>
<script>
    var nav = 'nav1_none';
    var vote = (function ($, Vue, w, undefined) {
        'use strict';
        var vmain;
        var refresh = function () {
            w.waitloading();
            $.ajax({
                type: "GET",
                url: '/hanbj/pub/json_vote',
                dataType: "json",
                success: function (msg) {
                    vmain.ans = msg;
                    vmain.refresh = Date();
                },
                error: function (jqXHR, msg, ethrow) {
                    w.msgto(jqXHR, msg, ethrow);
                },
                complete: function () {
                    w.cancelloading();
                }
            });
            setTimeout(refresh, 600000);
        };
        var init = function () {
            vmain = new Vue({
                el: '#fame',
                data: {
                    ans: '',
                    refresh: ''
                },
                methods: {},
                ready: function () {
                    refresh();
                }
            });
        };
        return {
            init: init
        };
    })(jQuery, Vue, window);
    $(window).load(function () {
        vote.init();
    });
</script>