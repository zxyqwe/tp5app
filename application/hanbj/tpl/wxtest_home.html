{layout name="wxlayout" /}
<script type="text/html" id="tpl_home">
    <div class="page" id="objmain">
        <div class="page__hd">
            <h1 class="page__title">{{ uname }}</h1>
            <p class="page__desc">{{ name }}</p>
        </div>
        <div class="page__bd page__bd_spacing">

        </div>
        <div class="page__ft">
        </div>
    </div>
</script>
<script type="text/javascript" src="/static/wx_test.js"></script>
<div id="testdata" class="sr-only">{$obj}</div>
<script>
    var wx_test = (function ($, Vue, w, undefined) {
        'use strict';
        var vmain, vtest, testdata;
        var init = function () {
            testdata = $('#testdata').html();
            testdata = JSON.parse(testdata);
            vmain = new Vue({
                el: '#objmain',
                data: {
                    uname: testdata.uname,
                    name: testdata.name,
                    test: testdata.test,
                    ans: testdata.ans,
                    cur_q: '',
                    cur_a: [],
                    cur_i: 0,
                    user_a: 0
                },
                methods: {
                    next: function (n) {
                        vmain.cur_i = vmain.cur_i + n;
                        var tmp = vmain.test[vmain.cur_i];
                        vmain.cur_q = tmp.q;
                        vmain.cur_a = tmp.a;
                        vmain.user_a = vmain.ans[vmain.cur_i];
                    }
                }
            });
        };
        return {
            init: init
        };
    })(Zepto, Vue, window);
    $(window).on("load", function () {
        wx_init.init(false);
        wx_test.init();
    });
</script>